#降臨鉄道: 模型モノレールを利用した遠隔通信
####Camera on Rails: Telecommunication with Model Monorail Trains

##概要
カメラを登載した模型モノレールをオフィスの天井で走らせることによって，どこからでもオフィスの様子を覗いたりオフィス内の人間と会話したりできる遠隔通信システムを作成した．車輪で移動可能なロボットを利用することによって遠隔地のユーザが会議や学会に参加する試みが近年盛んになっているが，混雑した環境ではロボットが自由に移動できないため実運用が難しいことが多い．邪魔物が無い天井に装着したレール上を自由に移動できるモノレールを利用することにより，実用的な遠隔コミュニケーションシステムが実現できた．

##Abstract
We developed the "Camera on Rails" telecommunication system with which a user can communicate with other people in a distance office through a camera on a model monorail train running on the ceiling of the office. Using our system, the user can monitor the current status of the office by running the train on the ceiling and have conversation with the people in the office.

##第1章 はじめに
###1.1 研究背景
遠隔地の人と同じ場所にいるかのような感覚を強化するテレプレゼンスシステムの研究が盛んであり、近年では、自宅警備、家族との会話、ビデオ会議などを目的としたテレプレゼンスロボットが販売されている。アメリカでは600万人以上がオフィスに行かずに自宅から仕事をしており[1]、リアルな人間の代理を務めるテレプレゼンスロボットを導入する企業も出てきている．2014年に開催されたWISS2014では、Double RoboticsのDouble[2]というテレプレゼンスロボットの導入により、遠隔地の人間が会議に参加可能になっていた（図 1.1）．
ロボットやビデオ会議などのテレプレゼンスシステムの市場規模は2015年には2010年の2倍以上にあたる50億円に達すると言われており、今後も利用はさらに拡大していくと考えられる。

####1.1.1 テレプレゼンス
テレプレゼンスとは遠隔地の人間と実際に対面しているかのような臨場感を提供する技術のことである。テレプレゼンスの研究には2通りのアプローチがあり、1つはその場にいるかのような臨場感を提供することで遠隔での作業を実現するもの、もう1つは遠隔地の相手と実際に対面している感覚を強化してより自然なコミュニケーションを取ることを目指すものである。前者は災害時に使われるレスキューロボットのように危険な場所などでの作業に適している。後者はテレビ電話やビデオ会議など作業ではなくコミュニケーションを目的とした場面で活躍している。

###1.2 研究目的
現在販売されている多くのテレプレゼンスロボットが持つ機能は、移動のための車輪、遠隔地を映すカメラ、会話のためのマイクとスピーカーなどである。移動は段差や障害物がある場所では身動きがとれなくなってしまったり、広い公共空間においてはあまり速くない速度のせいで巡回が難しかったりする状況が多い。また、カメラも広い視野角を持っているわけではなく、周りの状況がよく見えず他の人の邪魔をしてしまうことも多々ある。このように既存のテレプレゼンスロボットには高い身体性、機動性を十分に発揮する機能が備わっておらず、自由な移動を実現し本当に便利に利用するにはまだまだ改善が必要であると考える。

###1.3 降臨鉄道
降臨鉄道（図 ）は天井にカメラを搭載した模型モノレール走らせることによってどこからでもオフィスの様子を覗いたりオフィス内の人間と会話したりできる遠隔通信システムである。天井を移動することによって、車輪で移動するロボットにはない高い機動性や自由な移動を実現した。
降臨鉄道のユーザはWebページにアクセスすることによって遠隔地のリアルタイム映像を見ながら天井にあるモノレールを移動させたり、遠隔地のユーザと会話したりすることができる．混雑した環境ではロボットが自由に移動できないため実運用が難しいことが多いが、邪魔物が無い天井に装着したレール上を自由に移動できるモノレールを利用することにより，実用的な遠隔コミュニケーションシステムが実現できた．

##第2章 関連研究
Doubleの他にも人間を模したテレプレゼンスロボットは多数販売されており、SuitableTechnologies の Beam[] や Revolve Robotics の Kubi[] 、Anybots の QB Avataなどがある。
吉川らは人間同士のコミュニケーションでは表情や身振り手振りなどの非言語情報が重要であるとし、対話相手を3次元形状で表示することによって高い臨場感を得ることができる遠隔通信システムを実装している[]．
福井らは磁石モジュールを用いて天井を移動するロボット実装している[]。この研究はコミュニケーションを目的としたものではないが、天井を「人間が平常では使用しない空間」とし、移動の自由度の高いロボットを実現している。
明興産業は工場の天井にレールを設置して空間監視管理を行うロボット（図 2.3）を製造している。ロボットには各種のセンサが積まれており、工場内での機械・プラントラインの操業状況や動作状態の監視や管理、異臭や異音の検知といった用途に利用されている。
Squarenetは天井を「唯一の空き空間」とし空間移動ロボットシステム（図 2.4）を製造している。天井空間を使用することで既存の設備レイアウトを変更することなく、工場内全域のロボット化を実現することができる。

####2.1 OB降臨システム
筆者の研究室では、卓上を動き回ることのできるロボットを利用した遠隔コミュニケーション支援システム「OB降臨システム（図 1.2）[]」を作成して運用している。OB降臨システムは筆者の研究室で運用されているガンタンク（「機動戦士ガンダム」に登場する有人式人型ロボット兵器）のプラモデルを介した遠隔コミュニケーション支援システムである。2ちゃんねる等に有名人が書き込みをすることを「降臨」と呼ぶことになぞらえて、ロボットに乗り移って研究室に「降臨」したOBとの円滑な会話を実現する。OBや有名人など畏怖すべき存在が目の前にいると緊張して上手く話せないように、テレプレゼンスを強化するとネットワーク越しの会話とはいえ同じ問題が起こるのではないかと考え、あえて小型のロボットにOBが降臨しテレプレゼンスを低下させることで両者の円滑なコミュニケーションを支援した。
OB降臨システムは使って楽しいシステムではあったが、ケーブルの制約のため動ける範囲が狭く、机の上の障害物のために移動が制限されたりカメラからの映像が見られなかったりすることも多かった（図 2.1）．

##第3章 実装
###3.1 システム構成
降臨鉄道システムは，Androidスマートフォンが取り付けられた懸垂式モノレール型のプラレール（タカラトミーの鉄道玩具）とWebサーバ，linda-serverから構成される．

###3.2 降臨鉄道
####3.2.1 懸垂式モノレール型プラレール
懸垂式モノレール型プラレールの筐体内部にはAndroidスマートフォンから出力された440Hz正弦波信号に基づいてリレーを駆動させることによってDCモータでの前進/後退を制御する回路が入っている。この機能の実装にあたって図3.1のような回路を実装した。Androidスマートフォンから出力された正弦波信号をオペアンプで増幅したものを整流平滑したものでトランジスタを駆動させリレーを駆動させている。
電源はUSB接続のモバイルバッテリーを使用し、オペアンプやリレー、DCモータへの電源、Androidスマートフォンの給電を行っている． 

####3.2.2 Android
使用したAndroidスマートフォンはSonyのXperia rayである。
懸垂式モノレール型プラレールにはAndroidスマートフォンが取り付けられている。このAndroidスマートフォンのイヤホン端子は懸垂式モノレール型プラレール筐体内部のDCモータを制御する回路に繋がっている。移動指示に従って正弦波信号をL/Rイヤホン端子に出力する。
カメラからの映像の配信にはAndroidアプリケーションIP Webcamを使用し、MotionJPEG形式の映像をHTTP通信で配信している。

###3.3 Webページ
####3.3.1 ユーザが利用するページ
降臨鉄道のユーザはブラウザからWebページにアクセスすることで降臨鉄道を利用できる。Webページを開くと研究室のリアルタイム映像と降臨鉄道の操作インタフェースが表示される（図 3.2）。
研究室のリアルタイム映像は、Androidスマートフォンから配信されているMotionJPEG形式の映像をHTMLのIMGタグで埋め込むことで表示している。
降臨鉄道の操作は左に進む、右に進む、停止するの3つのボタンを押すことでlinda-serverに移動指示を送っている。

####3.3.2 Androidスマートフォンが利用するページ
懸垂式モノレール型プラレールに取り付けられたAndroidスマートフォンはブラウザからAndroidスマートフォン用ページにアクセスすることで、ユーザ用ページからの移動指示に従ってモータを制御する機能を動作させることができる（図 3.3）。Androidスマートフォンは移動指示を受け取ると、440Hz正弦波信号をイヤホン端子から出力する、つまり、440Hzの音のMP3ファイルを再生する。停止指示があった場合はMP3ファイルの再生を停止する。

###3.4 linda-server
操作は並列計算プリミティブLindaをWebサーバ上に実装したlinda-serverを用いて実装している．クライアントはJavaScriptで実装した。

####3.4.1 Linda
Lindaとは1980 年代にイェール大学で生まれた並列処理を行うための実装モデルである。タプルスペース(tuplespace)と呼ばれる共有メモリ空間に、型つきのデータレコード(タプル)を格納する。in/out/rd/inp/rdp という命令で操作することで、大抵の並列処理が記述できる。
降臨鉄道では、博士課程の橋本翔氏が開発したlinda-serverというサーバ環境を用いて実装を行った。linda-server は Heroku で運用されている。

####3.4.2 降臨鉄道での実装内容
ユーザが利用するWebページからlinda-serverに書き込むため、タプルを送信する側のサーバを実装する。

```
  var server_url = "http://linda-server.herokuapp.com";
  var socket = io.connect(server_url);
  var linda = new Linda().connect(socket);
  var ts = linda.tuplespace("korin");
  linda.io.on("connect", function(){});
```

linda-serverにkorinというタプルスペースを作成し接続する。
これでlinda-server.herokuapp.com/korinとの通信が可能になった。
次に、右に進む、左に進む、停止するボタンを押した時にタプルをkorinに送信する。

```
  function move_right(){
    ts.write({type: "move", cmd: "right"});
  }
  
  function move_left(){
    ts.write({type: "move", cmd: "left"});
  }
  
  function move_stop(){
    ts.write({type: "move", cmd: "stop"});
  }
```

このwriteによってkorinにタプルが書き込まれる。
この状態をlinda-server.herokuapp.com/korinで確認すると、以下のようにlinda-serverのkorinにタプルが書き込まれていることが分かる（図 3.4）。

次に、Androidスマートフォンからlinda-serverの命令を読み取るクライアント側を実装する。
先程の送信側サーバと同じくkorinに接続し、タプルが書き込まれたらwatchして読み取る。これによりリアルタイムな送受信が可能となる。

```
  ts.watch({type: "move", cmd: "left"}, function(err, tuple){
    play_left();
  });
  
  ts.watch({type: "move", cmd: "right"}, function(err, tuple){
    play_right();
  });
  
  ts.watch({type: "move", cmd: "stop"}, function(err, tuple){
    play_stop();
  });
```

##第4章 考察
天井にカメラを設置するというと監視カメラや防犯カメラを思い浮かべる人が多いだろう。確かに実際に運用では研究室の様子をくまなく見ることができた。OB降臨システムの場合は見られたくないときに卓上のロボットを隠してしまうということが可能だったが、降臨鉄道は天井にあるためそれができない。研究室はパブリックな空間であり見られて困るようなことはないのだが、自分以外は誰もいない部屋なのに見られているかもしれないという不安を感じさせる。研究室にいる人の「見られてもよい」と降臨する人の「見たい」が同時にあるときにだけ動作できる仕組みがあると良い。
また、今後の課題として次の点が挙げられる．

(1)複数の人が参加できない 
本実装では使用している模型モノレールが1つしかないため，複数の人が同時にアクセスした場合1つの模型モノレールを共同で使うことになる。模型モノレールの操作が重複した場合、自分が思った操作ができないと考えられる。誰かが操作している間にアクセスした場合は後からアクセスした人は模型モノレールの操作ができないようにするなど複数人が同時にシステムを利用することができる仕組みが必要である．

(2)任意の場所への移動
レールに沿って走るという制約があるため，レールのない場所に移動したり任意の場所に瞬時に移動したりすることができない．カメラの角度を変えたりズームできるようにしたりするなどの工夫が必要である。

(3)「駅」での充電
本実装では電源に使用しているモバイルバッテリーの充電が切れた時に，天井に登って人間の手で充電済みのバッテリーと交換をしている．バッテリーの充電を自動で行う「駅」を設置することで運用する上での負担を減らすことができるだろう．

###第5章 おわりに
本研究では，カメラを登載した模型モノレールをオフィスの天井で走らせることによって，どこからでもオフィスの様子を覗いたりオフィス内の人間と会話したりできる遠隔通信システム「降臨鉄道」作成した．今回のデモで紹介したシステムは現在，研究室内で実際の運用を通じて実験中である。
降臨鉄道は遠隔コミュニケーションシステムとして利用するのはもちろんのこと，多くの人が集まるイベント会場などで遠隔イベント参加システムとして利用できるだろう．
将来的には目的に応じたロボットを複数個用意し，世代間を超えてより活発な研究活動ができるようにしたいと考えている．

##謝辞
本研究を進める上で、多大なご指導を下さった増井俊之教授、実装に協力いただいた橋本翔氏、中山拓哉氏に大変感謝を申し上げます。
また、研究を進める上で様々なアドバイズをくださった増井研究室の皆様にも御礼申し上げます。

##参考文献
[1] Data Access and Dissemination Systems (DADS), http://factfinder.census.gov/faces/tableservices/jsf/pages/productview.xhtml?pid=ACS_12_1YR_DP03&prodType=table
[2] Double Robotics - Telepresence Robot for Telecommuters, http://www.doublerobotics.com
[3] Beam+ Smart Presence System, https://www.suitabletech.com/beam-plus/
[4] Revolve Robotics - Kubi Telepresence Robot, https://revolverobotics.com
[5] Products | Anybots, https://www.anybots.com/products/
[6] 吉川恭平, 町田貴史, 清川清, 竹村治雄, 大野浩之: 低解像度レンジファインダと高解像度カメラを併用した高臨場感空間共有通信, 電子情報通信学会技術研究報告. PRMU, パターン認識・メディア理解 103(584), 63-66, 2004-01-15.
[7] 福井類, 森下広, 原田達也, 森武俊, 佐藤知正: 生活環境中で人と共棲可能な永久磁石誘導型天井移動ロボットプラットフォーム, 日本ロボット学会誌 28(9), 1120-1130, 2010-11-15.
[8] 明興産業株式会社, http://www.meikos.co.jp/robo.html
[9] 天井空間移動ロボットシステム, http://www.squarenet.co.jp/squaremeister-j.htm
[10] 廣田馨, 橋本翔, 増井俊之 : OB降臨システム, インタラクション2011, (2011).
[11] IP Webcam - Google Play, https://play.google.com/store/apps/details?id=com.pas.webcam
[12] node-linda/linda - GitHub, https://github.com/node-linda/linda
[13] Heroku | Cloud Application Platform, https://www.heroku.com